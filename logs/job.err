INFO:root:running main pipeline...
INFO:root:running preliminary checks/setup...
INFO:root:checking kwargs dict...
INFO:root:updating training flags...
INFO:root:loading data...
INFO:numexpr.utils:Note: detected 72 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 72 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
INFO:numexpr.utils:NumExpr defaulting to 16 threads.
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
INFO:root:data shapes: (210432, 16), (35040, 16), (35040, 16);  (210432, 1), (35040, 1), (35040, 1)
INFO:root:training base models...
INFO:root:skipping training base_model_linreg.
INFO:root:skipping training base_model_hgbr.
INFO:root:skipping training base_model_nn.
INFO:root:saving base model results...
INFO:root:plotting base model results...
INFO:root:computing base model metrics...
INFO:root:running posthoc UQ methods...
INFO:root:No posthoc methods found and/or whitelisted. Skipping...
INFO:root:saving posthoc UQ results...
INFO:root:plotting posthoc results...
INFO:root:running native UQ methods...
INFO:root:running native methods...
INFO:root:running native_quantile_regression_nn...
WARNING:root:IO_Helper param filename_parts is None, so not all functionality will be available!
WARNING:root:IO_Helper param methods_kwargs is None, so not all functionality will be available!
INFO:root:training from scratch...
INFO:root:setup
INFO:root:setup model
INFO:root:setup meta-models
INFO:root:map to cuda
INFO:root:setup training
  0%|          | 0/300 [00:00<?, ?it/s]INFO:root:training...
  0%|          | 0/300 [00:23<?, ?it/s]
Traceback (most recent call last):
  File "/mnt/qb/work/ludwig/lqb589/my_code/uq_comparison_pipeline.py", line 801, in <module>
    main()
  File "/mnt/qb/work/ludwig/lqb589/my_code/uq_comparison_pipeline.py", line 786, in main
    uq_comparer.compare_methods(
  File "/mnt/qb/work/ludwig/lqb589/my_code/uq_comparison_pipeline_abc.py", line 196, in compare_methods
    native_results = self.run_native_methods(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/qb/work/ludwig/lqb589/my_code/uq_comparison_pipeline_abc.py", line 472, in run_native_methods
    y_pred, y_quantiles, y_std = native_method(
                                 ^^^^^^^^^^^^^^
  File "/mnt/qb/work/ludwig/lqb589/my_code/uq_comparison_pipeline.py", line 453, in native_quantile_regression_nn
    model = train_qr_nn(
            ^^^^^^^^^^^^
  File "/mnt/qb/work/ludwig/lqb589/my_code/src_uq_methods_native/quantile_regression_nn.py", line 209, in train_qr_nn
    loss.backward(grad)
  File "/home/ludwig/lqb589/.conda/envs/masterarbeit/lib/python3.12/site-packages/torch/_tensor.py", line 572, in backward
    return handle_torch_function(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ludwig/lqb589/.conda/envs/masterarbeit/lib/python3.12/site-packages/torch/overrides.py", line 1717, in handle_torch_function
    result = mode.__torch_function__(public_api, types, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ludwig/lqb589/.conda/envs/masterarbeit/lib/python3.12/site-packages/torch/utils/_device.py", line 106, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ludwig/lqb589/.conda/envs/masterarbeit/lib/python3.12/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/ludwig/lqb589/.conda/envs/masterarbeit/lib/python3.12/site-packages/torch/autograd/__init__.py", line 340, in backward
    grad_tensors_ = _make_grads(tensors, grad_tensors_, is_grads_batched=False)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ludwig/lqb589/.conda/envs/masterarbeit/lib/python3.12/site-packages/torch/autograd/__init__.py", line 163, in _make_grads
    raise RuntimeError(
RuntimeError: Mismatch in shape: grad_output[0] has a shape of torch.Size([20, 99]) and output[0] has a shape of torch.Size([12, 99]).
