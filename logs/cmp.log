INFO:root:running metrics computation script
WARNING:root:At least one IO_Helper param of [filename_parts, methods_kwargs] is None, so not all functionality will be available!
INFO:root:loading train/test data
INFO:root:updating run size setup
INFO:numexpr.utils:Note: detected 72 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 72 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
INFO:numexpr.utils:NumExpr defaulting to 16 threads.
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
INFO:root:computing metrics on test data only
INFO:root:loading predictions
INFO:root:loading array from comparison_storage/arrays2/base_model_hgbr_n210432_it30_its3.npy
INFO:root:computing metrics for base_model_hgbr:
INFO:root:deterministic metrics...
INFO:root:metrics: {'mae': 137.00952874299506, 'rmse': 182.22024990175242, 'smape_scaled': 0.010668871156271827}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_base_model_hgbr.json
INFO:root:loading array from comparison_storage/arrays2/base_model_linreg_n210432.npy
INFO:root:computing metrics for base_model_linreg:
INFO:root:deterministic metrics...
INFO:root:metrics: {'mae': 212.31085205078125, 'rmse': 283.3730163574219, 'smape_scaled': 0.01683916710317135}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_base_model_linreg.json
INFO:root:loading array from comparison_storage/arrays2/base_model_nn_n210432_it400_nh2_hs50.npy
INFO:root:computing metrics for base_model_nn:
INFO:root:deterministic metrics...
INFO:root:metrics: {'mae': 152.47723388671875, 'rmse': 197.17701721191406, 'smape_scaled': 0.011858620680868626}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_base_model_nn.json
INFO:root:loading array from comparison_storage/arrays2/native_qhgbr_y_pred_n210432_it0.npy
INFO:root:loading array from comparison_storage/arrays2/native_qhgbr_y_quantiles_n210432_it0.npy
INFO:root:loading array from comparison_storage/arrays2/native_qhgbr_y_std_n210432_it0.npy
INFO:root:computing metrics for native_qhgbr:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 146.04834811184008, 'rmse': 193.37619023624, 'smape_scaled': 0.01131276340713315, 'crps': 95.12779962658475, 'nll_gaussian': 6.65869389418966, 'mean_pinball': 28.686894836688225, 'ssr': 0.8163265178726956}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_native_qhgbr.json
INFO:root:loading array from comparison_storage/arrays2/native_quantile_regression_nn_y_pred_n210432_it300_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_quantile_regression_nn_y_quantiles_n210432_it300_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_quantile_regression_nn_y_std_n210432_it300_nh2_hs50.npy
INFO:root:computing metrics for native_qr:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 144.5478973388672, 'rmse': 188.0083770751953, 'smape_scaled': 0.011198005639016628, 'crps': 103.47415866836371, 'nll_gaussian': 6.691803974377721, 'mean_pinball': 17.510683059692383, 'ssr': 0.925160203482286}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_native_qr.json
INFO:root:loading array from comparison_storage/arrays2/native_gpytorch_y_pred_n210432_it200_new.npy
INFO:root:loading array from comparison_storage/arrays2/native_gpytorch_y_quantiles_n210432_it200_new.npy
INFO:root:loading array from comparison_storage/arrays2/native_gpytorch_y_std_n210432_it200_new.npy
INFO:root:computing metrics for native_gp:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 135.6634979248047, 'rmse': 179.49716186523438, 'smape_scaled': 0.010449154302477837, 'crps': 96.33389239803527, 'nll_gaussian': 6.60204953880807, 'mean_pinball': 18.667144212255973, 'ssr': 0.8816581988029228}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_native_gp.json
INFO:root:loading array from comparison_storage/arrays2/native_mvnn_y_pred_n210432_it100_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_mvnn_y_quantiles_n210432_it100_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_mvnn_y_std_n210432_it100_nh2_hs50.npy
INFO:root:computing metrics for native_mvnn:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 152.9539337158203, 'rmse': 197.52330017089844, 'smape_scaled': 0.011976061388850212, 'crps': 111.23457908485594, 'nll_gaussian': 6.9657040752057835, 'mean_pinball': 15.858065698144665, 'ssr': 0.6806311599966159}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_native_mvnn.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_hgbr_y_pred_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_hgbr_y_quantiles_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_hgbr_y_std_n210432_it5.npy
INFO:root:computing metrics for posthoc_cp_hgbr:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 137.00952874299506, 'rmse': 182.22024990175242, 'smape_scaled': 0.010668871156271827, 'crps': 99.19522777601125, 'nll_gaussian': 6.6802031111016795, 'mean_pinball': 16.03511006735679, 'ssr': 0.8029626824569794}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_posthoc_cp_hgbr.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_linreg_y_pred_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_linreg_y_quantiles_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_linreg_y_std_n210432_it5.npy
INFO:root:computing metrics for posthoc_cp_linreg:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 212.31094360351562, 'rmse': 283.373046875, 'smape_scaled': 0.016839176416397095, 'crps': 152.77682913302723, 'nll_gaussian': 7.067612506515193, 'mean_pinball': 31.135430538177612, 'ssr': 1.0453441282738993}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_posthoc_cp_linreg.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_nn_y_pred_n210432_it5_cp2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_nn_y_quantiles_n210432_it5_cp2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_nn_y_std_n210432_it5_cp2.npy
INFO:root:computing metrics for posthoc_cp_nn:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 152.4772186279297, 'rmse': 197.17701721191406, 'smape_scaled': 0.011858620680868626, 'crps': 108.41700300498587, 'nll_gaussian': 6.7137698884969605, 'mean_pinball': 19.816665475179263, 'ssr': 0.9047224499704415}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_posthoc_cp_nn.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_laplace_approximation_base_model_nn_y_pred_n210432_it1000_la2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_laplace_approximation_base_model_nn_y_quantiles_n210432_it1000_la2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_laplace_approximation_base_model_nn_y_std_n210432_it1000_la2.npy
INFO:root:computing metrics for posthoc_la_nn:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 152.4772186279297, 'rmse': 197.17701721191406, 'smape_scaled': 0.011858620680868626, 'crps': 108.16621751186423, 'nll_gaussian': 6.703755257151063, 'mean_pinball': 22.641995871496103, 'ssr': 0.9735054200953219}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_test_posthoc_la_nn.json
