INFO:root:running metrics computation script
WARNING:root:At least one IO_Helper param of [filename_parts, methods_kwargs] is None, so not all functionality will be available!
INFO:root:loading train/test data
INFO:numexpr.utils:Note: detected 72 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 72 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
INFO:numexpr.utils:NumExpr defaulting to 16 threads.
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
/mnt/qb/work/ludwig/lqb589/my_code/helpers/misc_helpers.py:116: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  arr.drop(columns=ts_cols, inplace=True)  # todo: works bc no ts cols present?
INFO:root:loading predictions
INFO:root:loading array from comparison_storage/arrays2/base_model_hgbr_n210432_it30_its3.npy
INFO:root:computing metrics for base_model_hgbr:
INFO:root:deterministic metrics...
INFO:root:metrics: {'mae': 107.4264018114817, 'rmse': 144.8874805194339, 'smape_scaled': 0.007782410197490579}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_base_model_hgbr.json
INFO:root:loading array from comparison_storage/arrays2/base_model_linreg_n210432.npy
INFO:root:computing metrics for base_model_linreg:
INFO:root:deterministic metrics...
INFO:root:metrics: {'mae': 229.26187133789062, 'rmse': 312.9999084472656, 'smape_scaled': 0.016828548163175583}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_base_model_linreg.json
INFO:root:loading array from comparison_storage/arrays2/base_model_nn_n210432_it400_nh2_hs50.npy
ERROR:root:when loading arrays for base_model_nn, file 'comparison_storage/arrays2/base_model_nn_n210432_it400_nh2_hs50.npy' couldn't be found. skipping method.
INFO:root:loading array from comparison_storage/arrays2/native_qhgbr_y_pred_n210432_it0.npy
INFO:root:loading array from comparison_storage/arrays2/native_qhgbr_y_quantiles_n210432_it0.npy
INFO:root:loading array from comparison_storage/arrays2/native_qhgbr_y_std_n210432_it0.npy
INFO:root:computing metrics for native_qhgbr:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 118.57336965302147, 'rmse': 163.46268260839227, 'smape_scaled': 0.008572835257446313, 'crps': 76.4171033820736, 'nll_gaussian': 6.381935623764352, 'mean_pinball': 25.311579997445406, 'ssr': 0.9279289517290202}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_native_qhgbr.json
INFO:root:loading array from comparison_storage/arrays2/native_quantile_regression_nn_y_pred_n210432_it300_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_quantile_regression_nn_y_quantiles_n210432_it300_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_quantile_regression_nn_y_std_n210432_it300_nh2_hs50.npy
INFO:root:computing metrics for native_qr:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 154.99310302734375, 'rmse': 205.80068969726562, 'smape_scaled': 0.011081885546445847, 'crps': 111.57766143312888, 'nll_gaussian': 6.802250336930342, 'mean_pinball': 18.654499053955078, 'ssr': 0.8659473530298781}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_native_qr.json
INFO:root:loading array from comparison_storage/arrays2/native_gpytorch_y_pred_n210432_it200_new.npy
INFO:root:loading array from comparison_storage/arrays2/native_gpytorch_y_quantiles_n210432_it200_new.npy
INFO:root:loading array from comparison_storage/arrays2/native_gpytorch_y_std_n210432_it200_new.npy
INFO:root:computing metrics for native_gp:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 125.88999938964844, 'rmse': 175.0900115966797, 'smape_scaled': 0.009035229682922363, 'crps': 87.76561913598589, 'nll_gaussian': 6.40331970010799, 'mean_pinball': 17.709605678375535, 'ssr': 0.8574868492102086}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_native_gp.json
INFO:root:loading array from comparison_storage/arrays2/native_mvnn_y_pred_n210432_it100_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_mvnn_y_quantiles_n210432_it100_nh2_hs50.npy
INFO:root:loading array from comparison_storage/arrays2/native_mvnn_y_std_n210432_it100_nh2_hs50.npy
INFO:root:computing metrics for native_mvnn:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 145.331787109375, 'rmse': 190.79637145996094, 'smape_scaled': 0.010475989431142807, 'crps': 104.45220837783589, 'nll_gaussian': 6.752671221065809, 'mean_pinball': 15.684084225907068, 'ssr': 0.6968976472430898}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_native_mvnn.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_hgbr_y_pred_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_hgbr_y_quantiles_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_hgbr_y_std_n210432_it5.npy
INFO:root:computing metrics for posthoc_cp_hgbr:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 107.4264018114817, 'rmse': 144.8874805194339, 'smape_scaled': 0.007782410197490579, 'crps': 77.4408154237755, 'nll_gaussian': 6.3949916195490495, 'mean_pinball': 16.03511006735679, 'ssr': 1.0098599280941094}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_posthoc_cp_hgbr.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_linreg_y_pred_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_linreg_y_quantiles_n210432_it5.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_linreg_y_std_n210432_it5.npy
INFO:root:computing metrics for posthoc_cp_linreg:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 229.26194763183594, 'rmse': 312.9999084472656, 'smape_scaled': 0.01682855561375618, 'crps': 166.7120364084501, 'nll_gaussian': 7.1682911815335455, 'mean_pinball': 31.135430696728214, 'ssr': 0.9463975632816303}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_posthoc_cp_linreg.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_nn_y_pred_n210432_it5_cp2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_nn_y_quantiles_n210432_it5_cp2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_conformal_prediction_base_model_nn_y_std_n210432_it5_cp2.npy
INFO:root:computing metrics for posthoc_cp_nn:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 144.67515563964844, 'rmse': 192.6067657470703, 'smape_scaled': 0.010394271463155746, 'crps': 103.78238957414356, 'nll_gaussian': 6.685780660097147, 'mean_pinball': 19.816665627415084, 'ssr': 0.9261900712464475}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_posthoc_cp_nn.json
INFO:root:loading array from comparison_storage/arrays2/posthoc_laplace_approximation_base_model_nn_y_pred_n210432_it1000_la2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_laplace_approximation_base_model_nn_y_quantiles_n210432_it1000_la2.npy
INFO:root:loading array from comparison_storage/arrays2/posthoc_laplace_approximation_base_model_nn_y_std_n210432_it1000_la2.npy
INFO:root:computing metrics for posthoc_la_nn:
INFO:root:deterministic metrics...
INFO:root:UQ metrics...
INFO:root:metrics: {'mae': 144.6751708984375, 'rmse': 192.6067657470703, 'smape_scaled': 0.010394271463155746, 'crps': 103.93409538740393, 'nll_gaussian': 6.6795957902965, 'mean_pinball': 22.641740072586067, 'ssr': 0.9965938855690675}
INFO:root:saving metrics...
INFO:root:saving metrics to comparison_storage/metrics/uq_metrics_posthoc_la_nn.json
